# Project Template

Gradle project template.

## Overview

This project is build using:

- JDK 21
- Gradle 9.2.1

The conventions wrap the commonly used plugins with pre-defined configurations:

- Application (bundled with Gradle)
- Base (bundled with Gradle)
- Detekt 2.0.0-alpha.1
- Dokka 2.1.0
- JaCoCo (bundled with Gradle)
- jOOQ Codegen 3.20.10
- Kotlin JVM 2.3.0
- Kotlin Plugin Spring 2.3.0
- Kotlinter 5.3.0
- OWASP Dependency Check 12.1.9
- SonarQube 7.2.2.6593
- Spring Boot 4.0.1

This project defines conventions for:

- Root project
    - Applies and configures base plugin
        - Adds lifecycle tasks
    - Applies and configures OWASP Dependency Check plugin
        - Generates reports required by SonarQube
        - Reads suppression file from `<rootProject>/config/dependency-check/suppression.xml`
        - Excludes non-application dependencies from check
        - NVD API key is configurable via `dependency-check.nvd-api-key` property
    - Applies and configures SonarQube plugin
        - Attaches reports generated by OWASP Dependency Check

- Kotlin project
    - Applies and configures Kotlin JVM plugin
        - All configuration should be in Kotlin block instead of Java block
        - JDK version is configurable via `java.version` property (default: 21)
        - Experimental Path API is configurable via `kotlin.experimental-path-api` property (default: false)
    - Applies and configures JaCoCo plugin
        - Runs always with tests
        - Generates reports required by SonarQube
    - Applies and configures Kotlinter plugin
        - Gradle fails the build if there are violations
        - Generates only human-readable reports
    - Applies and configures Detekt plugin
        - Gradle fails the build if there are violations
        - Runs in parallel
        - Reads configuration file from `<rootProject>/config/detekt/detekt.yml`
        - Applies configuration on top of default configuration
        - Reads baseline file from `<rootProject>/config/detekt/baseline.xml`
        - Generates only human-readable reports
    - Applies and configures Dokka plugin
        - Sets footer with copyright message
    - Gradle doesn't fail the build if there are no tests
    - Adds license file to JARs

- Application
    - Applies and configures application plugin
        - Sets main class
        - Main class is configurable via `application.main-class` property

- Spring Boot project
    - Applies Kotlin project conventions
    - Applies and configures Kotlin Spring plugin

- Spring Boot application
    - Applies and configures Spring Boot plugin
        - Generates build info for Spring Boot Actuator
    - Applies and configures Git Properties plugin
        - Always generates Git info for Spring Boot Actuator
        - Gradle doesn't fail the build if the project is not a Git repository
    - Doesn't generate plain JAR (only generates fat JAR)

- jOOQ Codegen
    - Applies and configures jOOQ Codegen plugin
        - Generates Kotlin code from SQL scripts
        - SQL scripts are configurable via `jooq-codegen.scripts` property (default: `src/main/resources/schema.sql`)
        - Target package is configurable via `ooq-codegen.package` property (default: `$group.db.schema`)

All conventions should:

- Be written using task configuration avoidance API
- Not define redundant configurations (e.g. if a plugin already configures a task in a certain way, the convention
  should not reconfigure it the same way)

This template contains:

- Gradle Wrapper
- Gradle version catalogs and platforms for dependency management
    - This project doesn't use Spring Dependency Management plugin
- Gradle properties
    - Defines project group and version
    - Configures Gradle cache and parallelism
- Git
    - Minimal .gitignore for IntelliJ IDEA, Gradle and Kotlin
- EditorConfig
    - IntelliJ IDEA settings with Kotlin style guide applied as baseline
    - Changes to general configuration
        - Use CRLF end of lines
    - Changes to Kotlin configuration
        - Don't use imports with `*`
        - Add `jakarta` and `kotlinx` to import layout
    - Changes to JSON and YAML configuration
        - Use indent size 2
    - Changes to properties configuration
        - Keep blank lines
        - Insert space around key-value delimiter
    - Changes to Ktlint configuration
        - Force multi-line function parameters only when exceeding max line length
- Documentation files (CHANGELOG.md, LICENSE, README.md)
- Empty configuration files for Detekt and OWASP Dependency Check
- Sample Spring Boot application (in subproject)

## Quickstart

Run the following command to format the Kotlin code:

```bash
./gradlew formatKotlin
```

Run the following command to build the project:

```bash
./gradlew clean build
```

Run the following command to run the sample application:

```bash
./gradlew sample-app:bootRun --args='--spring.profiles.active=local'
```
